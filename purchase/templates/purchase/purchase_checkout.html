{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load static %}


{% block content %}

<div class="row justify-content-center">
    <div class="col-8">
      <label>First Name:</label>
      <input class="textinput textInput form-control mb-2" readonly value="{{ profile.user.first_name }}"> 
      <label>Last Name:</label>
      <input class="textinput textInput form-control mb-2" readonly value="{{ profile.user.last_name }}"> 
      <form action="{% url 'purchase_checkout' %}" method="POST" id="payment-form">
         {% csrf_token %}
         {{ form | crispy }}
         <label>Purchase details:</label>
         {% for info in cart_content %}
         <p class="textinput textInput form-control mb-2">{{ info.program.name}} | {{ info.program.type }} | {{ info.program.price }}€</p>
         {% endfor %}
         <label>Total Cost:</label>
         <p class="textinput textInput form-control mb-2">{{ total }}€</p>
         <div class="mb-3" id="card-element">
          <!-- Elements will create input elements here -->
         </div>

         <!-- We'll put the error messages in this element -->
         <div id="card-errors" role="alert"></div>
         <a href="{% url 'cart' %}" class="btn btn-danger">Cancel</a>
         <button class="btn btn-success" id="submit-btn">Pay and Confirm</button>
      </form>
    </div>
</div>

{% endblock %}

{% block additionaljs %}

   {{ block.super }}

   {{ stripe_public_key|json_script:"id_stripe_public_key" }}
   {{ client_secret|json_script:"id_client_secret" }}

   <script src="{% static '/js/stripe.js' %}"></script>

{% endblock %}